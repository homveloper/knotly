# Milestone 4: 검색 및 접근성

## 📋 마일스톤 개요

**기간**: Week 11-12 (2주)
**목표**: 전체 텍스트 검색, 키보드 단축키, 스크린 리더 지원으로 생산성과 접근성을 개선합니다.

## 💡 비즈니스 가치

### 왜 이 기능이 필요한가?

Milestone 3에서 실시간 협업이 완성되었다면, 이제 **워크스페이스 내에서 정보를 빠르게 찾고** **키보드만으로 효율적으로 작업**할 수 있어야 합니다. 노드가 수십 개 이상 쌓이면 스크롤로 찾는 것은 비효율적입니다. 전체 텍스트 검색은 Notion, Obsidian 같은 노트 앱의 핵심 기능입니다.

### 키보드 우선 워크플로우

마우스 없이 키보드만으로 노드 생성, 이동, 검색을 수행할 수 있으면 생산성이 극대화됩니다. Vim, Emacs 사용자나 개발자들은 키보드 단축키를 선호하며, 이는 포트폴리오에서 "Power User 경험을 고려했다"는 강점이 됩니다.

### 접근성은 법적 요구사항

WCAG 2.1 AA 레벨을 준수하면 장애인 사용자도 스크린 리더로 Knotly를 사용할 수 있습니다. 이는 법적 요구사항일 뿐만 아니라 사용자 기반을 넓히는 전략입니다. 미국, 유럽의 공공기관이나 대기업은 접근성 준수 제품만 도입합니다.

## 📖 사용자 스토리

### Story 1: 전체 텍스트 검색
```
As a 사용자
I want to Cmd+K 또는 Ctrl+K로 검색창을 열고 노드 내용을 검색하면
So that 원하는 정보를 빠르게 찾을 수 있다
```

**수용 기준**:
- Cmd+K(macOS) 또는 Ctrl+K(Windows/Linux)로 검색 모달이 열린다
- 입력 중 실시간으로 노드 목록이 필터링된다 (200ms 디바운싱)
- 검색 결과를 클릭하면 해당 노드로 캔버스가 이동하고 하이라이트된다
- 검색어가 노드 내용에서 볼드 처리되어 표시된다

### Story 2: 키보드 단축키
```
As a 파워 유저
I want to 마우스 없이 키보드만으로 모든 작업을 수행할 수 있도록
So that 생산성을 극대화할 수 있다
```

**수용 기준**:
- `N` 키로 새 노드 생성 (캔버스 중앙에 생성)
- `Enter` 키로 선택된 노드 편집 모드 진입
- `Backspace` 키로 선택된 노드 삭제 (확인 모달 표시)
- `Tab` 키로 노드 간 포커스 이동
- `Esc` 키로 모달 닫기 또는 편집 모드 종료
- `?` 키로 단축키 치트시트 모달 표시

### Story 3: 스크린 리더 지원
```
As a 시각 장애인 사용자
I want to 스크린 리더가 노드 내용과 위치를 읽어주도록
So that 비시각적으로도 워크스페이스를 탐색할 수 있다
```

**수용 기준**:
- 모든 노드에 `role="article"` 속성이 있다
- 노드 내용이 `aria-label`로 제공된다
- FAB 버튼에 `aria-label="새 노드 추가"` 속성이 있다
- 포커스가 시각적으로 표시된다 (파란색 outline)
- 스크린 리더가 "노드 5개, 엣지 3개"와 같은 요약 정보를 읽어준다

### Story 4: 고대비 모드
```
As a 저시력 사용자
I want to 고대비 색상 테마를 선택할 수 있도록
So that 노드를 더 명확하게 구분할 수 있다
```

**수용 기준**:
- 설정에서 "고대비 모드" 토글이 제공된다
- 활성화 시 배경색이 #000000, 노드 테두리가 #FFFFFF로 변경된다
- 텍스트 색상이 #FFFFFF로 변경되어 대비율이 7:1 이상이 된다
- prefers-contrast 미디어 쿼리를 감지하여 자동 활성화된다

## ✅ 성공 지표

### 완료 조건
- [ ] Cmd+K 또는 Ctrl+K로 검색 모달이 열린다
- [ ] 검색어 입력 시 200ms 디바운싱으로 노드 목록이 필터링된다
- [ ] 검색 결과 클릭 시 해당 노드로 캔버스가 이동하고 3초간 하이라이트된다
- [ ] N, Enter, Backspace, Tab, Esc, ? 키보드 단축키가 작동한다
- [ ] 모든 인터랙티브 요소에 `role`, `aria-label`, `tabindex` 속성이 있다
- [ ] 포커스가 파란색 outline으로 시각적으로 표시된다
- [ ] 고대비 모드에서 대비율이 7:1 이상이다
- [ ] NVDA, VoiceOver, JAWS 스크린 리더로 테스트를 통과한다

### 데모 시나리오
1. 사용자가 Cmd+K를 눌러 검색 모달을 연다
2. "프로젝트"를 입력하면 해당 단어가 포함된 노드 3개가 표시된다
3. 첫 번째 결과를 클릭하면 캔버스가 해당 노드로 이동한다
4. 노드가 3초간 노란색으로 하이라이트된다
5. N 키를 눌러 새 노드를 생성한다
6. Tab 키를 눌러 다른 노드로 포커스를 이동한다
7. Enter 키를 눌러 편집 모드로 진입한다
8. Esc 키를 눌러 편집 모드를 종료한다
9. ? 키를 눌러 단축키 치트시트를 확인한다
10. 스크린 리더가 "노드 5개, 엣지 3개"를 읽어준다

## 🎨 UI/UX 요구사항

### 검색 모달
- **위치**: 화면 중앙에 모달로 표시
- **크기**: 최대 너비 600px, 최대 높이 400px
- **입력창**: 상단에 고정, 플레이스홀더 "노드 검색... (Cmd+K)"
- **결과 목록**: 스크롤 가능, 각 항목에 노드 내용 미리보기 (최대 100자)
- **하이라이트**: 검색어가 볼드 처리되어 표시
- **빈 상태**: "검색 결과가 없습니다" 메시지 표시

### 단축키 치트시트
- **트리거**: ? 키 또는 우상단 물음표 아이콘
- **레이아웃**: 2열 테이블 형태 (단축키 | 설명)
- **카테고리**: 노드 편집, 탐색, 검색으로 구분
- **예시**:
  - N | 새 노드 생성
  - Enter | 편집 모드 진입
  - Cmd+K | 검색 모달 열기
  - Tab | 다음 노드로 이동
  - Esc | 모달 닫기

### 포커스 표시
- **outline**: 2px solid #3B82F6 (파란색)
- **offset**: 2px
- **border-radius**: 4px

### 고대비 모드
- **배경**: #000000
- **노드 테두리**: #FFFFFF, 3px
- **텍스트**: #FFFFFF
- **선택된 노드**: #FFFF00 (노란색 배경)

## 🚫 제약사항

### 이 단계에서 제외되는 것
- ❌ 정규표현식 검색 (Phase 2에서 추가)
- ❌ 태그 기반 필터링 (Milestone 5에서 태그 기능 추가 후 구현)
- ❌ 검색 히스토리 (Phase 2에서 추가)
- ❌ 다국어 접근성 (Phase 2에서 i18n 추가 후 구현)
- ❌ 음성 명령 (Phase 3 실험)

### 기술적 제약
- 검색은 클라이언트 로컬 상태에서만 수행한다 (서버 검색은 나중에 추가)
- 키보드 이벤트는 전역 리스너로 구현한다 (키 충돌 주의)
- 스크린 리더 테스트는 NVDA(Windows), VoiceOver(macOS)만 수행한다

## 📊 KPI

### 정량적 지표
- **검색 응답 시간**: < 200ms (디바운싱 제외)
- **키보드 단축키 응답 시간**: < 50ms
- **WCAG 2.1 AA 준수율**: 100%
- **대비율**: 최소 4.5:1 (일반 모드), 7:1 (고대비 모드)

### 정성적 지표
- 5명의 파워 유저에게 마우스 없이 노드 10개 작성 테스트
- "키보드만으로 충분하다"는 피드백 80% 이상
- 2명의 스크린 리더 사용자에게 테스트
- "내용을 이해할 수 있다"는 피드백 100%
